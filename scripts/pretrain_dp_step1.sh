# dog soup pretraining

# Train with DP
python src/train_owlvit.py --model owlvit-base-patch32 --dataset dog_soup --sub_datasets all --descriptors chatgpt --prompt_type 0 --batch_size 160 --batch_size_val 160 --save_freq 2 --num_workers 16 --devices 4,5,6,7 --epochs 64 --lr 0.00002 --weight_decay 0.01 --project_name dogsoup_pretrain_stage1 --loss_weight 0,0,0,0,1 --network_type contrastive --freeze_box_heads --logits_from_teacher --num_negatives_train 140 --num_negatives_val 120 --early_stopping 10 --enable_dp --scheduler_patience 4 --scheduler_verbose --train_file /home/lab/datasets/dogsoup/v1_train.h5 --val_file /home/lab/datasets/dogsoup/v1_val.h5 --test_file /home/lab/datasets/dogsoup/v1_test.h5 --birdsoup_level 1 --note lr2e-5_b160_stop10_patience4_e64_wd1e-2 --descriptor_path /home/peijie/workspace/xclip_ext/peeb/data/descriptors/chatgpt/descriptors_dogsoup_v1_gpt4.json

# Train with DDP on 1 node
torchrun --standalone --nnodes=1 --nproc-per-node=4 src/train_owlvit.py --model owlvit-base-patch32 --dataset dog_soup --sub_datasets all --descriptors chatgpt --prompt_type 0 --batch_size 40 --batch_size_val 40 --save_freq 2 --num_workers 16 --devices 0,1,2,3 --epochs 64 --lr 0.00002 --weight_decay 0.01 --loss_weight 0,0,0,0,1 --network_type contrastive --freeze_box_heads --logits_from_teacher --num_negatives_train 60 --num_negatives_val 120 --early_stopping 10 --scheduler_patience 4 --scheduler_verbose --train_file /home/lab/datasets/dogsoup/v1_train.h5 --val_file /home/lab/datasets/dogsoup/v1_val.h5 --test_file /home/lab/datasets/dogsoup/v1_test.h5 --birdsoup_level 1 --note lr2e-5_b160_stop10_patience4_e64_wd1e-2 --descriptor_path /home/peijie/workspace/xclip_ext/peeb/data/descriptors/chatgpt/descriptors_dogsoup_v1_gpt4.json --project_name ddp_dogsoup_pretrain_stage1
